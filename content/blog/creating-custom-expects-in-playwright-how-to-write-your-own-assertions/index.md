+++
date = 2023-06-26
title = "å¦‚ä½•åœ¨playwrightä¸­åˆ›å»ºè‡ªå®šä¹‰æ–­è¨€"
description = "å¯ä»¥éå¸¸æ˜¾è‘—çš„å¢åŠ æµ‹è¯•ä»£ç çš„å¯è¯»æ€§"
authors = ["ä¹™é†‡"]
[taxonomies]
tags = ["playwrightè¿›é˜¶", "ç¿»è¯‘"]
[extra]
math = false
image = "banner.jpg"
+++

æˆ‘å–œæ¬¢é˜…è¯»ï¼Œç‰¹åˆ«æ˜¯åœ¨æ°”æ¸©åœ¨ 80 åæ°åº¦ä¸­æ®µçš„æ—¶å€™ã€‚ååœ¨æ³³æ± è¾¹ï¼Œæ‰‹æ§ä¸€æœ¬å¥½ä¹¦ï¼Œæ˜¯å¤šä¹ˆæƒ¬æ„çš„äº«å—ã€‚å½“ä¸€æœ¬ä¹¦å†™å¾—å¾ˆå¥½æ—¶ï¼Œé˜…è¯»èµ·æ¥å°±å¾ˆè½»æ¾ï¼Œæˆ‘å¯ä»¥èŠ±å‡ ä¸ªå°æ—¶ç¿»é¡µï¼Œè®©æˆ‘çš„æƒ³è±¡åŠ›åˆ›é€ åœºæ™¯å’Œäººç‰©â€¦â€¦å…¶å®ä»£ç ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚å½“ä»£ç å†™å¾—å¾ˆå¥½æ—¶ï¼Œæˆ‘é€šè¿‡é˜…è¯»å®ƒå°±èƒ½è½»æ¾ç†è§£æµ‹è¯•/æ–­è¨€åœ¨åšä»€ä¹ˆï¼Œå°±åƒè¯»ä¹¦ä¸€æ ·ã€‚æˆ‘å°½é‡å†™å‡ºå¯è¯»æ€§å¼ºçš„ä»£ç ï¼šä»æœ‰æ„ä¹‰çš„å˜é‡ååˆ°åœ¨é€»è¾‘ä¸Šåˆé€‚çš„åœ°æ–¹æ·»åŠ ç©ºè¡Œï¼ˆâ€œæ„å¤§åˆ©é¢æ¡ç±»å‹çš„ä»£ç â€æˆ‘å®åœ¨çœ‹ä¸ä¸‹å»ï¼‰ã€‚

Playwright å¯ä»¥æ¯”è¾ƒå®¹æ˜“çš„ç¼–å†™å‡ºå¯è¯»æ€§å¼ºçš„ä»£ç ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š

```javascript
import { expect } from "@playwright/test";

expect(student.grade).toBeGreaterThanOrEqual(1);
expect(student.loan).toBeTruthy();
expect(student.employer).toBeNull();
```

## é»˜è®¤æ–­è¨€

è¿™æ˜¯ä¸€ä¸ªé€šç”¨å€¼æ–­è¨€çš„[é“¾æ¥](https://playwright.dev/docs/api/class-genericassertions)ã€‚

ä½†æ˜¯å¦‚æœä½ æœŸæœ›ä¸€ä¸ªå­—ç¬¦ä¸²è€Œä½ ä¸å¤ªå…³å¿ƒå…¶å€¼ï¼Œåªæƒ³æ£€æŸ¥å…¶ç±»å‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œæ²¡æœ‰å¼€ç®±å³ç”¨çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¥å‰æ˜¯è¿™æ ·å†™çš„ï¼š

```javascript
// æˆ‘ä»¥å‰å¦‚ä½•æ£€æŸ¥å­—ç¬¦ä¸²
let framework = "playwright";

expect(typeof framework).toBe("string");
```

æˆ‘ä¸æ˜¯è¯´å®ƒä¸å¯è¯»ï¼Œä½†æˆ‘æ›´å¸Œæœ›ä»£ç å†™æˆè¿™æ ·ï¼š

```javascript
// æˆ‘ç°åœ¨å¦‚ä½•æ£€æŸ¥å­—ç¬¦ä¸²
let framework = "playwright";

expect(framework).toBeString();
```

å¦‚æœä½ é˜…è¯»äº†ä¸Šé¢ä»£ç å—ä¸­çš„æ³¨é‡Šï¼ˆå¦ä¸€ç§ä½¿ä»£ç å¯è¯»çš„æ–¹æ³•ï¼‰ï¼Œä½ å¯èƒ½å·²ç»çŒœåˆ°å¯ä»¥ç¼–å†™è‡ªå·±çš„ expectã€‚ä½ æ¥åˆ°è¿™ä¸ªé¡µé¢æ˜¯ä¸ºäº†æ‰©å±•ä½ çš„çŸ¥è¯†ï¼Œç°åœ¨æˆ‘ä»¬è¦æ‰©å±•ä½ çš„ expectï¼

è¦ä½¿ `toBeString()` æ£€æŸ¥å·¥ä½œï¼Œä½ éœ€è¦åœ¨ `playwright.config.ts` ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹

playwright.config.tsğŸ‘‡

```javascript
expect.extend({
  toBeString(received: string) {
    const check = typeof received == "string";

    if (check) {
      return {
        message: () => "passed",
        pass: true,
      };
    } else {
      return {
        message: () =>
          `toBeString() æ–­è¨€å¤±è´¥ã€‚\nä½ æœŸæœ› '${received}' æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ª ${typeof received}\n`,
        pass: false,
      };
    }
  },
});
```

è§£é‡Šï¼šæˆ‘ä»¬é€šè¿‡æ·»åŠ  `toBeString()` æ–­è¨€æ‰©å±•äº†æˆ‘ä»¬çš„ expectã€‚å³ä½¿çœ‹èµ·æ¥æ–­è¨€æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œä½†å®é™…ä¸Šå¹¶æ²¡æœ‰ã€‚ `received` æ˜¯ `expect(value)` çš„ç¬¬ä¸€ä¸ªæ‹¬å·ä¸­çš„å€¼ã€‚ç„¶åæˆ‘ä»¬æ£€æŸ¥æ¥æ”¶åˆ°çš„å€¼æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ£€æŸ¥é€šè¿‡ã€‚å¦‚æœä¸æ˜¯ï¼Œæˆ‘ä»¬å°±è®©æ£€æŸ¥å¤±è´¥ï¼Œå¹¶é€šè¿‡æ·»åŠ è‡ªå®šä¹‰æ¶ˆæ¯ä½¿ä»£ç æ›´å…·å¯è¯»æ€§ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

```javascript
let value = 123;

expect(value).toBeString();
```

è¿™ä¸ªæ–­è¨€ä¼šå¤±è´¥ â˜¹ï¸

ç”±äºåœ¨è¿™ä¸ªä¾‹å­ä¸­ `value` æ˜¾ç„¶ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘é¢„è®¡å®ƒä¼šå¤±è´¥ã€‚æœç„¶ä¸å‡ºæ‰€æ–™ï¼Œæ³¨æ„è‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯ï¼Œè¿™ä¸ªå¾ˆå¥½ ğŸ‘‡ã€‚

![å›¾ç‰‡2](https://playwrightsolutions.com/content/images/2023/06/2023-06-24_09-35-32-1.jpg)

æˆ‘è¿˜åœ¨æˆ‘çš„å·¥å…·åŒ…ä¸­æ·»åŠ äº† `.toBeNumber()` å’Œ `.toBeBoolean()`ã€‚

å‡ å‘¨å‰ï¼Œæˆ‘å†™äº† `.toBeOneOfValues()`ï¼Œè¿™æ˜¯ä¸€ä¸ªæ”¹å˜æ¸¸æˆè§„åˆ™çš„æ–¹æ³•ã€‚æˆ‘åœ¨æ— æ³•é¢„æµ‹ç¡®åˆ‡å€¼çš„æ—¶å€™ä½¿ç”¨å®ƒï¼Œä½†æˆ‘çŸ¥é“å®ƒåº”è¯¥æ˜¯å·²çŸ¥å€¼ä¹‹ä¸€ã€‚æˆ‘ä¸»è¦ç”¨äºä¸º GET è¯·æ±‚ç¼–å†™ API æ£€æŸ¥ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘æœ‰ä¸€ä¸ªè¿”å›çš„æ”¶è´¹å‚æ•°ï¼Œå®ƒå¯èƒ½æ˜¯â€œpendingâ€ï¼ˆå¾…å¤„ç†ï¼‰ã€â€œfailedâ€ï¼ˆå¤±è´¥ï¼‰æˆ–â€œsuccessfulâ€ï¼ˆæˆåŠŸï¼‰ï¼Œæˆ‘åªæƒ³æ£€æŸ¥æ¯ä¸€ä¸ªè¿”å›çš„ç»“æœéƒ½æœ‰ä¸€ä¸ªé¢„æœŸçš„å€¼ã€‚

```javascript
let validValues = ["failed", "pending", "successful"];
let testValue = "created";

expect(testValue).toBeOneOfValues(validValues);
```

åœ¨åº•å±‚æˆ‘ä»¬å°†æ£€æŸ¥æ•°ç»„æ˜¯å¦åŒ…å«ä¼ é€’çš„å€¼

åŒæ ·ï¼Œå®ƒä¼šæ‰“å°å‡ºè‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯ ğŸ‘‡ã€‚

![å›¾ç‰‡3](https://playwrightsolutions.com/content/images/2023/06/2023-06-24_10-56-02.jpg)

ä»¥ä¸‹æ˜¯éœ€è¦æ·»åŠ åˆ° `playwright.config.ts` ä¸­çš„æºä»£ç 

playwright.config.ts

```javascript
expect.extend({
  toBeOneOfValues(received: any, array: any[]) {
    const check = array.includes(received);

    if (check) {
      return {
        message: () => "é€šè¿‡",
        pass: true,
      };
    } else {
      return {
        message: () =>
          `toBeOneOfValues() æ–­è¨€å¤±è´¥ã€‚\nä½ æœŸæœ› [${array}] åŒ…å« '${received}'\n`,
        pass: false,
      };
    }
  },
});
```

è¿™é‡Œæœ€é‡è¦çš„æ”¶è·æ˜¯è¦æ„è¯†åˆ°ä½ å¯ä»¥åˆ›å»ºä½ éœ€è¦çš„è‡ªå®šä¹‰æ–­è¨€ï¼Œä»¥æé«˜å¯è¯»æ€§ã€‚å¯¹æˆ‘æœ‰å¸®åŠ©çš„æ˜¯æŸ¥çœ‹æˆ‘è¦æ£€æŸ¥çš„å€¼ï¼Œå¹¶åœ¨è„‘æµ·ä¸­è¯´â€œæˆ‘å¸Œæœ›è¿™ä¸ªå€¼â€¦â€¦â€ç„¶åç”¨è‹±è¯­å®Œæˆè¿™ä¸ªå¥å­ã€‚è¿™æ ·ä½ å°±å¾—åˆ°äº†ä¼ªä»£ç ã€‚(ä¸­æ–‡ç”¨æˆ·è¡¨ç¤ºå¢åŠ è‹±æ–‡çš„å¯è¯»æ€§å…¶å® ğŸ˜‚ï¼Œä½ æ‡‚çš„)

è¿™ç¯‡æ–‡ç« æ˜¯åŸºäº[æ­¤æ–‡æ¡£](https://playwright.dev/docs/test-configuration#add-custom-matchers-using-expectextend)ç¼–å†™çš„ã€‚å¦‚æœä½ ä½¿ç”¨ TypeScriptï¼Œåˆ™éœ€è¦é¢å¤–çš„ä¸€æ­¥ä½¿è‡ªå®šä¹‰æ–­è¨€å·¥ä½œï¼Œè¿™æ¶‰åŠæ·»åŠ ä¸€ä¸ª `global.d.ts` æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä¸ºä¸Šè¿°ä¸¤ä¸ª expect ç¼–å†™çš„æ–‡ä»¶ã€‚

global.d.ts

```typescript
export {};

declare global {
  namespace PlaywrightTest {
    interface Matchers<R> {
      toBeOneOfValues(array: any[]): R;
      toBeString(): R;
    }
  }
}
```

## æ¥æº

URL æ¥æº: https://playwrightsolutions.com/creating-custom-expects-in-playwright-how-to-write-your-own-assertions/

å‘å¸ƒæ—¶é—´: 2023-06-26T12:30:49.000Z
